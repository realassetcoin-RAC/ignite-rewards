# RAC Rewards Platform - Complete Product Features

## üìã **Table of Contents**
1. [Platform Overview](#platform-overview)
2. [User Types & Access](#user-types--access)
3. [Loyalty NFT System](#loyalty-nft-system)
4. [Web3 Investment System](#web3-investment-system)
5. [Merchant Dashboard](#merchant-dashboard)
6. [Referral System](#referral-system)
7. [Third-Party Integration](#third-party-integration)
8. [Security & Compliance](#security--compliance)
9. [Technical Features](#technical-features)
10. [Implementation Status](#implementation-status)

---

## üéØ **Platform Overview**

The RAC Rewards Platform is a comprehensive Web3-native loyalty and investment ecosystem that combines traditional loyalty programs with blockchain technology, NFT-based rewards, and direct investment opportunities in impactful asset initiatives.

### **Core Value Proposition**
- **Dual User Experience**: Custodial and Non-Custodial wallet support
- **NFT-Based Loyalty**: Unique loyalty cards with upgradeable benefits
- **Web3 Investment**: Direct investment in environmental, social, and governance initiatives
- **Merchant Integration**: Complete merchant dashboard with custom NFT creation
- **Global Reach**: GMT timezone enforcement for worldwide consistency

---

## üë• **User Types & Access**

### **A. Custodial Users (Platform Wallet Users)**

#### **Signup Process**
- ‚úÖ **Email/Google Authentication**: Signup via email or Google OAuth
- ‚úÖ **Terms Acceptance**: Automatic terms of use and privacy policy acceptance
- ‚úÖ **Loyalty NFT Assignment**: Automatic free loyalty NFT card with predefined benefits
- ‚úÖ **Wallet Creation**: Automatic wallet address creation with 12-word seed phrase
- ‚úÖ **Loyalty Number**: Unique 8-character loyalty number (e.g., J0000001)

#### **Authentication & Security**
- ‚úÖ **Seed Phrase Backup**: Option to backup seed phrases for account recovery
- ‚úÖ **Seed Phrase Login**: Login capability using seed phrases
- ‚úÖ **Wallet Display**: Wallet address display in user dashboard
- ‚úÖ **Google Auth Disable**: Option to disable Google auth for seed phrase-only access
- ‚úÖ **Session Management**: 5-minute inactivity logout
- ‚úÖ **MFA System**: TOTP-based multi-factor authentication with backup codes

#### **Solana Custodial Wallet System**
- ‚úÖ **Automatic Wallet Creation**: Unique Solana custodial wallet automatically created for ALL users (email + Google)
- ‚úÖ **Unique Seed Phrases**: Each user gets a unique 12-word BIP39 seed phrase for their wallet
- ‚úÖ **Universal Access**: Both email and Google users receive Solana wallets by default
- ‚úÖ **Seed Phrase Backup**: Users can backup their seed phrases through the dashboard
- ‚úÖ **Seed Phrase Login**: Users can login using their seed phrases instead of email/Google
- ‚úÖ **Auth Method Control**: Users can disable email/Google authentication and use only seed phrases
- ‚úÖ **Wallet Management**: Complete wallet creation, backup, and recovery system
- ‚úÖ **Database Integration**: Standardized `user_solana_wallets` table for all wallet operations
- ‚úÖ **Security Features**: Encrypted seed phrase storage with secure backup options

#### **Loyalty NFT Management**
- ‚úÖ **One NFT Limit**: Maximum one loyalty NFT per account
- ‚úÖ **NFT Upgrade**: Upgrade feature with payment gateway integration
- ‚úÖ **Payment Integration**: "Proceed to Pay" popup for NFT purchases
- ‚úÖ **New Transaction Benefits**: New NFT features apply only to new transactions
- ‚úÖ **Dashboard Display**: Loyalty card display in top-left section

#### **Investment System**
- ‚úÖ **RAC Rewards Investment**: Use earned RAC rewards for micro-investments
- ‚úÖ **Asset Initiative Selection**: Choose one asset/initiative for investment flow
- ‚úÖ **DEX Integration**: Convert RAC to USDT via decentralized exchanges
- ‚úÖ **Multi-Currency Support**: Support for USDT, ETH, BTC, SOL investments

### **B. Non-Custodial Users (External Wallet Users)**

#### **Core Features**
- ‚úÖ **External Wallet Connection**: Connect MetaMask, Phantom, Trust Wallet, etc.
- ‚úÖ **Wallet Verification**: Cryptographic signature verification for ownership
- ‚úÖ **Direct Investment**: Invest directly from external wallets
- ‚úÖ **Multi-Currency Support**: USDT, SOL, ETH, BTC investment support
- ‚úÖ **Same Loyalty Features**: All loyalty features available to non-custodial users

---

## üé® **Loyalty NFT System**

### **NFT Types & Attributes**

#### **Custodial NFT Cards (Free for Platform Users)**
| Card Type | Price | Upgrade | Evolve | Rarity | Mint | Auto Staking | Earn on Spend | Upgrade Bonus | Evolution Min Investment | Evolution Earnings |
|-----------|-------|---------|--------|--------|------|--------------|---------------|---------------|------------------------|-------------------|
| Pearl White | $0 | Yes | Yes | Common | 10,000 | Forever | 1.00% | 0.00% | 100 RAC | 0.25% |
| Lava Orange | $100 | Yes | Yes | Less Common | 3,000 | Forever | 1.10% | 0.10% | 500 RAC | 0.50% |
| Pink | $100 | Yes | Yes | Less Common | 3,000 | Forever | 1.10% | 0.10% | 500 RAC | 0.50% |
| Silver | $200 | Yes | Yes | Rare | 750 | Forever | 1.20% | 0.15% | 1,000 RAC | 0.75% |
| Gold | $300 | Yes | Yes | Rare | 750 | Forever | 1.30% | 0.20% | 1,500 RAC | 1.00% |
| Black | $500 | Yes | Yes | Very Rare | 250 | Forever | 1.40% | 0.30% | 2,500 RAC | 1.25% |

#### **Non-Custodial NFT Cards (For External Wallet Users)**
| Card Type | Price | Upgrade | Evolve | Rarity | Mint | Auto Staking | Earn on Spend | Upgrade Bonus | Evolution Min Investment | Evolution Earnings |
|-----------|-------|---------|--------|--------|------|--------------|---------------|---------------|------------------------|-------------------|
| Pearl White | $100 | No | Yes | Common | 10,000 | Forever | 1.00% | 0.00% | 500 RAC | 0.50% |
| Lava Orange | $500 | No | Yes | Less Common | 3,000 | Forever | 1.10% | 0.00% | 2,500 RAC | 1.25% |
| Pink | $500 | No | Yes | Less Common | 3,000 | Forever | 1.10% | 0.00% | 2,500 RAC | 1.25% |
| Silver | $1,000 | No | Yes | Rare | 750 | Forever | 1.20% | 0.00% | 5,000 RAC | 0.15% |
| Gold | $1,000 | No | Yes | Rare | 750 | Forever | 1.30% | 0.00% | 5,000 RAC | 0.20% |
| Black | $2,500 | No | Yes | Very Rare | 250 | Forever | 1.40% | 0.00% | 13,500 RAC | 0.30% |

### **NFT Features**
- ‚úÖ **Auto-Staking**: Optional automatic reward locking
- ‚úÖ **Collections**: Support for different NFT collection types
- ‚úÖ **Rarity System**: Dynamic rarity levels with future updates
- ‚úÖ **Minting Control**: Defined number of NFTs per collection
- ‚úÖ **Fractionalized Investment**: NFT holders can invest in fractionalized assets
- ‚úÖ **Evolution System**: 3D NFT generation for eligible users
- ‚úÖ **Upgrade System**: Enhanced benefits for upgraded NFTs

---

## üí∞ **Web3 Investment System**

### **Asset Initiatives**
- ‚úÖ **Environmental Projects**: Renewable energy, climate solutions
- ‚úÖ **Social Impact**: Education, healthcare, community development
- ‚úÖ **Governance**: Transparent governance and voting systems
- ‚úÖ **Technology**: Innovation and digital transformation
- ‚úÖ **Healthcare**: Medical research and healthcare access
- ‚úÖ **Education**: Learning platforms and educational resources

### **Investment Features**
- ‚úÖ **Multi-Sig Wallets**: Each initiative has secure multi-signature wallets
- ‚úÖ **Hot/Cold Storage**: Separate hot and cold wallet management
- ‚úÖ **Direct Investment**: Users invest directly from their Web3 wallets
- ‚úÖ **Real-Time Tracking**: Live investment monitoring and returns
- ‚úÖ **Multi-Currency**: Support for USDT, ETH, BTC, SOL, RAC
- ‚úÖ **Risk Assessment**: Low, medium, high risk categorization
- ‚úÖ **Impact Scoring**: 1-10 impact score for each initiative
- ‚úÖ **Expected Returns**: Transparent return expectations

### **Investment Flow**
1. **Browse Initiatives**: Users explore available asset initiatives
2. **Select Initiative**: Choose preferred investment opportunity
3. **Connect Wallet**: Link Web3 wallet (MetaMask, Phantom, etc.)
4. **Verify Ownership**: Cryptographic signature verification
5. **Invest Directly**: Send funds to multi-sig wallet
6. **Track Returns**: Monitor investment performance and returns

---

## üè™ **Merchant Dashboard**

### **Subscription Plans**
| Plan | Monthly Price | Yearly Price | Monthly Points | Transactions | Features |
|------|---------------|--------------|----------------|--------------|----------|
| StartUp | $20 | $150 | 100 | 100 | Basic loyalty, email support |
| Momentum | $50 | $500 | 300 | 300 | Advanced features, priority support |
| Energizer | $100 | $1,000 | 600 | 600 | Premium features, account manager |
| Cloud | $250 | $2,500 | 1,800 | 1,800 | Enterprise features, 24/7 support |
| Super | $500 | $5,000 | 4,000 | 4,000 | Ultimate features, white-label |

### **Merchant Features**
- ‚úÖ **Transaction Management**: Edit transactions within 30 days
- ‚úÖ **QR Code Generation**: Create transaction QR codes
- ‚úÖ **Customer Management**: Track customer loyalty and points
- ‚úÖ **Analytics Dashboard**: Comprehensive business insights
- ‚úÖ **Custom NFT Creation**: Create branded loyalty NFTs (Momentum+ plans)
- ‚úÖ **Discount Programs**: Set up discount codes and promotions
- ‚úÖ **Subscription Management**: Upgrade/downgrade plans
- ‚úÖ **Payment Processing**: Integrated payment gateway

### **Custom NFT Features (Momentum+ Plans)**
- ‚úÖ **Branded NFTs**: Upload custom loyalty NFT designs
- ‚úÖ **Discount Integration**: Embed discount codes in NFTs
- ‚úÖ **QR Code Generation**: Unique QR codes for each NFT
- ‚úÖ **Usage Tracking**: Monitor NFT usage and redemption
- ‚úÖ **Validity Management**: Set expiration dates and limits

---

## üîó **Referral System**

### **Referral Types**
- ‚úÖ **User-to-User**: Standard points for referring other users
- ‚úÖ **User-to-Merchant**: Higher points for referring merchants
- ‚úÖ **Merchant-to-User**: Merchants can refer users
- ‚úÖ **Merchant-to-Merchant**: Merchants can refer other merchants

### **Campaign Management**
- ‚úÖ **Campaign Types**: 'user', 'merchant', or 'both' campaigns
- ‚úÖ **GMT Timezone**: All dates stored and displayed in GMT
- ‚úÖ **Campaign Caps**: Maximum referrals per user
- ‚úÖ **Automatic Settlement**: Referral rewards when criteria met
- ‚úÖ **Admin Dashboard**: Complete campaign management interface

### **Referral Features**
- ‚úÖ **Referral Codes**: Unique codes for each user/merchant
- ‚úÖ **Signup Integration**: Referral code fields in signup/login
- ‚úÖ **Point Rewards**: Configurable point rewards per referral
- ‚úÖ **Tracking System**: Complete referral tracking and analytics

---

## üîå **Third-Party Integration**

### **Loyalty Network Integration**
- ‚úÖ **Network Management**: Admin-defined loyalty networks
- ‚úÖ **Conversion Rates**: Configurable point conversion rates
- ‚úÖ **SMS OTP**: 5-minute validity with resend functionality
- ‚úÖ **Transfer System**: Port rewards from other loyalty partners
- ‚úÖ **Email Notifications**: Linking and transfer completion emails
- ‚úÖ **Mobile Verification**: SMS OTP for account linking

### **Supported Integrations**
- ‚úÖ **Email Service**: Comprehensive email notification system
- ‚úÖ **SMS Service**: OTP verification and notifications
- ‚úÖ **Payment Gateways**: Stripe, PayPal, Square integration
- ‚úÖ **Blockchain**: Solana NFT service integration
- ‚úÖ **DEX Integration**: Uniswap, PancakeSwap, Raydium, Jupiter

---

## üîí **Security & Compliance**

### **OWASP Top 10 Compliance**
- ‚úÖ **A01 - Access Control**: Proper authentication and authorization
- ‚úÖ **A02 - Cryptographic Failures**: Strong encryption and hashing
- ‚úÖ **A03 - Injection**: Parameterized queries and input validation
- ‚úÖ **A04 - Insecure Design**: Security-by-default principles
- ‚úÖ **A05 - Security Misconfiguration**: Secure defaults and configurations
- ‚úÖ **A06 - Vulnerable Components**: Regular dependency updates
- ‚úÖ **A07 - Authentication Failures**: MFA and strong password policies
- ‚úÖ **A08 - Data Integrity**: Code signing and integrity checks
- ‚úÖ **A09 - Logging Failures**: Comprehensive audit logging
- ‚úÖ **A10 - SSRF**: URL validation and allowlists

### **Database Security**
- ‚úÖ **Row Level Security**: RLS policies on all tables
- ‚úÖ **Encrypted Storage**: Sensitive data encryption
- ‚úÖ **Access Control**: Minimal required permissions
- ‚úÖ **Audit Logging**: Complete database access logging

### **Application Security**
- ‚úÖ **CSP Headers**: Content Security Policy implementation
- ‚úÖ **Secure Headers**: HSTS, X-Frame-Options, etc.
- ‚úÖ **Rate Limiting**: API endpoint rate limiting
- ‚úÖ **Input Validation**: Comprehensive input sanitization
- ‚úÖ **Error Handling**: Secure error messages without information disclosure

---

## üõ†Ô∏è **Technical Features**

### **Database Architecture**
- ‚úÖ **PostgreSQL**: Primary database with Supabase
- ‚úÖ **UUID Primary Keys**: Secure identifier generation
- ‚úÖ **Foreign Key Constraints**: Data integrity enforcement
- ‚úÖ **Indexes**: Performance optimization
- ‚úÖ **Triggers**: Automated data updates
- ‚úÖ **Functions**: Reusable database logic

### **Frontend Technology**
- ‚úÖ **React/TypeScript**: Modern frontend framework
- ‚úÖ **Next.js**: Server-side rendering and routing
- ‚úÖ **Tailwind CSS**: Utility-first styling
- ‚úÖ **Shadcn/ui**: Component library
- ‚úÖ **React Hook Form**: Form management
- ‚úÖ **Lucide Icons**: Consistent iconography

### **Backend Services**
- ‚úÖ **Supabase**: Backend-as-a-Service
- ‚úÖ **Real-time**: Live data synchronization
- ‚úÖ **Authentication**: Built-in auth system
- ‚úÖ **Storage**: File and image storage
- ‚úÖ **Edge Functions**: Serverless functions

### **Web3 Integration**
- ‚úÖ **Wallet Connection**: MetaMask, Phantom, Trust Wallet
- ‚úÖ **Smart Contracts**: Solana NFT integration
- ‚úÖ **Blockchain Monitoring**: Transaction tracking
- ‚úÖ **Multi-Sig Wallets**: Secure asset management
- ‚úÖ **DEX Integration**: Decentralized exchange support

### **Solana Custodial Wallet Implementation**
- ‚úÖ **Automatic Wallet Creation**: `SolanaWalletService.createWalletForUser()` creates wallets during signup
- ‚úÖ **BIP39 Seed Generation**: Unique 12-word seed phrases using industry-standard BIP39
- ‚úÖ **Database Storage**: Standardized `user_solana_wallets` table with encrypted seed phrases
- ‚úÖ **Auth Integration**: `AuthCallback.tsx` automatically creates wallets for all users
- ‚úÖ **Seed Phrase Backup**: `SeedPhraseBackup.tsx` component for secure backup management
- ‚úÖ **Seed Phrase Login**: `SeedPhraseLoginModal.tsx` with database authentication function
- ‚úÖ **Auth Control**: `SeedPhraseManager.tsx` allows disabling email/Google authentication
- ‚úÖ **Database Function**: `authenticate_with_seed_phrase()` function for secure login
- ‚úÖ **Universal Access**: Both email and Google users receive Solana wallets automatically
- ‚úÖ **Security Features**: Encrypted storage, secure backup, and recovery options

---

## üìä **Implementation Status**

### **‚úÖ Completed Features**
- [x] **User Authentication**: Email, Google OAuth, seed phrase login
- [x] **Solana Custodial Wallet System**: Automatic wallet creation, seed phrase management, auth control
- [x] **Loyalty NFT System**: Complete NFT management and upgrades
- [x] **Merchant Dashboard**: Full merchant management system
- [x] **Referral System**: Complete referral campaign management
- [x] **Third-Party Integration**: Email, SMS, payment gateways
- [x] **Web3 Investment**: Asset initiative investment system
- [x] **Security Implementation**: OWASP compliance and RLS
- [x] **Database Schema**: Complete database architecture
- [x] **Frontend Components**: All major UI components
- [x] **GMT Timezone**: Global timezone consistency

### **üîÑ In Progress**
- [ ] **Real-time Investment Tracking**: Live blockchain monitoring
- [ ] **Advanced Analytics**: Comprehensive reporting dashboard
- [ ] **Mobile App**: React Native mobile application
- [ ] **API Documentation**: Complete API documentation

### **üìã Planned Features**
- [ ] **White-label Solution**: Customizable platform branding
- [ ] **Advanced NFT Features**: More NFT types and benefits
- [ ] **Gamification**: Achievement and reward systems
- [ ] **Social Features**: Community and social interactions
- [ ] **Advanced Analytics**: AI-powered insights and recommendations

---

## üéØ **Key Differentiators**

1. **Web3-Native**: Built from the ground up for Web3 integration
2. **Universal Solana Wallets**: Automatic Solana custodial wallet creation for ALL users (email + Google)
3. **Dual User Experience**: Seamless custodial and non-custodial support
4. **Seed Phrase Authentication**: Users can login with seed phrases and disable traditional auth
5. **Impact Investment**: Direct investment in meaningful initiatives
6. **NFT-Based Loyalty**: Unique loyalty system with upgradeable benefits
7. **Global Consistency**: GMT timezone enforcement for worldwide users
8. **Security-First**: Comprehensive security and compliance implementation
9. **Merchant-Focused**: Complete merchant dashboard and management tools
10. **Scalable Architecture**: Built to handle millions of users and transactions

---

## üìà **Success Metrics**

- **User Engagement**: Daily active users and session duration
- **Investment Volume**: Total amount invested in asset initiatives
- **Merchant Adoption**: Number of active merchants and transactions
- **NFT Utilization**: NFT upgrades and evolution rates
- **Referral Success**: Referral conversion rates and rewards distributed
- **Security Compliance**: Zero security incidents and audit results

---

*This document serves as the comprehensive specification for the RAC Rewards Platform. All features listed are either implemented, in progress, or planned for future development.*

---

## üìÖ **Recent Updates**

### **January 28, 2025 - Solana Custodial Wallet System Implementation**
- ‚úÖ **Complete Implementation**: Automatic Solana wallet creation for ALL users (email + Google)
- ‚úÖ **Seed Phrase Management**: Full backup, login, and recovery system
- ‚úÖ **Auth Control**: Users can disable email/Google authentication and use only seed phrases
- ‚úÖ **Database Standardization**: Unified `user_solana_wallets` table across all components
- ‚úÖ **Security Features**: BIP39 seed generation, encrypted storage, secure authentication
- ‚úÖ **Universal Access**: Both email and Google users receive Solana wallets automatically

**Implementation Files:**
- `src/pages/AuthCallback.tsx` - Automatic wallet creation during signup
- `src/lib/solanaWalletService.ts` - Wallet management service
- `src/components/SeedPhraseBackup.tsx` - Seed phrase backup interface
- `src/components/SeedPhraseLoginModal.tsx` - Seed phrase login functionality
- `src/components/SeedPhraseManager.tsx` - Auth control and management
- Database function: `authenticate_with_seed_phrase()` for secure login
